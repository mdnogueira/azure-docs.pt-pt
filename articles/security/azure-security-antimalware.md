---
title: Antimalware da Microsoft para o Azure | Microsoft Docs
description: "Este artigo fornece uma descrição geral da arquitetura de Antimalware da Microsoft para o Azure, incluindo cenários suportados e configurações para ativar, configurar e implementar a proteção para máquinas virtuais e serviços Cloud do Azure. Abordaremos básicas de configuração, gestão e monitorização funcionalidade acessível através do Microsoft Azure gestão de serviço da API, scripts do PowerShell, o portal do Azure e o Visual Studio."
services: security
documentationcenter: na
author: YuriDio
manager: swadhwa
editor: 
ms.assetid: 265683c8-30d7-4f2b-b66c-5082a18f7a8b
ms.service: security
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 11/01/2017
ms.author: yurid
ms.openlocfilehash: 71ecb822c5e8234e8c8db4e60169e8dd3a6de81f
ms.sourcegitcommit: d41d9049625a7c9fc186ef721b8df4feeb28215f
ms.translationtype: MT
ms.contentlocale: pt-PT
ms.lasthandoff: 11/02/2017
---
# <a name="microsoft-antimalware-for-azure-cloud-services-and-virtual-machines"></a>Microsoft Antimalware for Azure Cloud Services and Virtual Machines
O cenário das ameaças modernas para ambientes de nuvem é extremamente dinâmico, aumentando a pressão de TI empresa subscritores para manter a proteção eficaz para satisfazer os requisitos de conformidade e segurança da nuvem. Antimalware da Microsoft para o Azure é a capacidade de proteção em tempo real livre que ajuda a identificar e remover vírus, spyware, e outro software malicioso, com alertas configuráveis ao conhecido software malicioso ou indesejável tenta instalar-se ou executar nos seus Sistemas do Azure.

A solução baseia-se a mesma plataforma de antimalware, como o Microsoft Security Essentials \[MSE\], Microsoft Forefront Endpoint Protection, o Microsoft System Center Endpoint Protection, o Windows Intune e o Windows Defender para Windows 8.0 e posterior. Antimalware da Microsoft para o Azure é uma solução de agente único para aplicações e ambientes de inquilino, concebidos para ser executado em segundo plano, sem qualquer intervenção humana. Pode implementar a proteção com base nas necessidades das cargas de trabalho aplicações, com o básico secure-por-predefinição ou avançadas de configuração personalizada, incluindo a monitorização de antimalware.

Quando implementar e ativar o Antimalware da Microsoft para o Azure para as suas aplicações, as seguintes funcionalidades de núcleos estão disponíveis:

* **Proteção em tempo real** -monitoriza as atividades nos serviços em nuvem e em máquinas virtuais para detetar e bloquear a execução de software maligno.
* **Agendar análise** -periodicamente efetua a análise de destino para detetar software maligno, incluindo ativamente em execução programas.
* **Remediação de software maligno** - automaticamente executa a ação no software maligno detetado, tais como eliminar ou quarentena ficheiros maliciosos e limpeza de entradas do registo malicioso.
* **Atualizações de assinatura** - automaticamente instala as assinaturas de proteção mais recentes (definições de vírus) para garantir a proteção está atualizada numa frequência previamente determinada.
* **Motor antimalware atualiza** – automaticamente atualiza o motor Antimalware da Microsoft.
* **Plataforma de antimalware atualiza** – automaticamente as atualizações a plataforma de Antimalware da Microsoft.
* **A proteção ativa** - relatórios metadados de telemetria sobre ameaças detetadas e os recursos suspeitos ao Microsoft Azure para garantir que a resposta rápida para a evolução das ameaças, bem como ativar a entrega de assinatura síncrono em tempo real através do o sistema de proteção ativa Microsoft (MAPS).
* **Amostras de relatórios** - fornece e relatórios de exemplos para o serviço de Antimalware da Microsoft para ajudar a otimizar o serviço e ative a resolução de problemas.
* **Exclusões** – permite que a aplicação e administradores de serviço configurar a determinados ficheiros, processos e as unidades para os excluir da proteção e ao analisar o desempenho e/ou outros motivos.
* **Recolha de eventos de antimalware** - regista o estado de funcionamento do serviço antimalware, atividades suspeitas e as ações de remediação executadas no registo de eventos de sistema operativo e recolhe-los para a conta de armazenamento do Azure do cliente.

> [!NOTE]
> Antimalware da Microsoft também podem ser implementado utilizando o Centro de segurança do Azure. Leitura [instalar o Endpoint Protection no Centro de segurança do Azure](../security-center/security-center-install-endpoint-protection.md) para obter mais informações.
>
>

## <a name="architecture"></a>Arquitetura
O Microsoft Antimalware para a solução do Azure inclui o Microsoft Antimalware cliente e o serviço, o modelo de implementação clássica Antimalware, os cmdlets do PowerShell de Antimalware e extensão de diagnóstico do Azure. A solução Antimalware da Microsoft é suportada no Windows Server 2008 R2, Windows Server 2012 e famílias de sistema operativo Windows Server 2012 R2. Não é suportada no sistema operativo Windows Server 2008 e também não é suportado no Linux. Suporte para o Windows Server 2016 com o Defender foi lançado, pode ler mais sobre esta atualização [aqui](https://blogs.msdn.microsoft.com/azuresecurity/2017/03/07/update-to-azure-antimalware-extension-for-cloud-services/).

O cliente de Antimalware da Microsoft e o serviço está instalado por predefinição num estado desativado em todas as famílias de sistema operativo convidado do Azure suportadas na plataforma de serviços em nuvem. O cliente de Antimalware da Microsoft e o serviço não está instalado por predefinição na plataforma de máquinas virtuais e está disponível como uma funcionalidade opcional através do portal do Azure e a configuração da máquina de Virtual do Visual Studio em extensões de segurança.

Ao utilizar o App Service do Azure, o serviço subjacente que aloja a aplicação web tem de Antimalware da Microsoft ativadas no mesmo. Esta é utilizada para proteger a infraestrutura de App Service do Azure e não é executado no conteúdo de cliente.

### <a name="microsoft-antimalware-workflow"></a>O fluxo de trabalho do Microsoft antimalware
O administrador de serviço do Azure pode ativar Antimalware para o Azure com uma predefinição ou uma configuração personalizada para as máquinas virtuais e serviços em nuvem com as seguintes opções:

* Máquinas virtuais – no portal do Azure, em **extensões de segurança**
* Máquinas virtuais – utilizar a configuração de máquinas virtuais do Visual Studio no Explorador de servidores
* Máquinas virtuais e serviços em nuvem – utilizando o Antimalware [modelo de implementação clássica](https://msdn.microsoft.com/library/azure/ee460799.aspx)
* Máquinas virtuais e serviços em nuvem – cmdlets do PowerShell de Antimalware a utilizar

Portal do Azure ou os cmdlets do PowerShell emitir o ficheiro de pacote de extensão de Antimalware para o sistema do Azure numa localização fixo previamente determinada. O agente convidado do Azure (ou o agente de recursos de infraestrutura) inicia a extensão de Antimalware, aplicar as definições de configuração de Antimalware fornecidas como entrada. Este passo ativa o serviço Antimalware com as definições de configuração personalizado ou predefinido. Se não for fornecida nenhum configuração personalizada, o serviço antimalware está ativado com as definições de configuração predefinida. Consulte o *Antimalware configuração* secção o [Antimalware da Microsoft para o Azure – exemplos de código](http://aka.ms/amazsamples "Microsoft Antimalware para a Cloud Services do Azure e exemplos de código VMs")para obter mais detalhes.

Depois de executar, o cliente de Antimalware da Microsoft transfere as definições de assinatura e de motor de proteção mais recentes a partir da Internet e carrega-os no sistema do Azure. O serviço Microsoft Antimalware escreve eventos relacionados com o serviço de registo de eventos de SO do sistema na origem de evento "Antimalware da Microsoft". Eventos incluem o estado de funcionamento de cliente Antimalware, estado de proteção e remediação, as definições de configuração antiga e nova, atualizações de motores e definições de assinatura e outras pessoas.

Pode ativar a monitorização de Antimalware para o seu serviço em nuvem ou Máquina Virtual para que os eventos de registo de eventos de Antimalware escritos como estes são produzidos à sua conta de armazenamento do Azure. O serviço Antimalware utiliza a extensão de diagnóstico do Azure para recolher eventos de Antimalware do sistema do Azure para tabelas na conta de armazenamento do Azure do cliente.

O fluxo de trabalho de implementação, incluindo os passos de configuração e as opções suportadas para cenários acima estão documentados na [cenários de implementação de Antimalware](#_Antimalware_Deployment_Scenarios) secção deste documento.

![Microsoft Antimalware no Azure](./media/azure-security-antimalware/sec-azantimal-fig1.PNG)

> [!NOTE]
> No entanto pode utilizar Powershell/APIs e os modelos Azure Resource Manager para implementar os conjuntos de dimensionamento de Máquina Virtual com a extensão de Microsoft Antimalware.  Para instalar uma extensão numa máquina Virtual já em execução, pode utilizar o script de python exemplo *vmssextn.py* localizado [aqui](https://github.com/gbowerman/vmsstools). Este script obtém a extensão de configuração existente no conjunto de dimensionamento e adiciona uma extensão para a lista de extensões existentes em conjuntos de dimensionamento de VM.
>
>

### <a name="default-and-custom-antimalware-configuration"></a>Configuração de Antimalware personalizadas e predefinidas
As predefinições de configuração são aplicadas para ativar o Antimalware de Cloud Services do Azure ou máquinas virtuais quando não fornecem definições de configuração personalizado. As predefinições de configuração tem sido previamente otimizadas para a execução no ambiente do Azure. Opcionalmente, pode personalizar estas definições de configuração predefinido conforme necessário para a aplicação do Azure ou a implementação de serviço e aplicá-las para obter outros cenários de implementação.

> [!NOTE]
> Por predefinição, a Interface de utilizador do Microsoft Antimalware no Azure Resource Manager estiver desativada, [cleanuppolicy.xml](https://blogs.msdn.microsoft.com/azuresecurity/2016/02/24/update-on-microsoft-antimalware-and-azure-resource-manager-arm-vms/) não é suportado o ficheiro para ignorar esta mensagem de erro. Para obter informações sobre como criar uma política personalizada, leia o artigo [ativar o Microsoft Antimalware Interface de utilizador no Azure Resource Manager VMs Post implementação](https://blogs.msdn.microsoft.com/azuresecurity/2016/03/09/enabling-microsoft-antimalware-user-interface-post-deployment/).
>
>

A tabela seguinte resume as definições de configuração disponíveis para o serviço Antimalware. As definições de configuração predefinido estão marcadas sob a coluna intitulada "Predefinido" abaixo.

![Tabela 1](./media/azure-security-antimalware/sec-azantimal-tb18.PNG)

## <a name="antimalware-deployment-scenarios"></a>Cenários de implementação de antimalware
Os cenários para ativar e configurar antimalware, incluindo a monitorização do Cloud Services do Azure e máquinas virtuais, são abordados nesta secção.

### <a name="virtual-machines---enable-and-configure-antimalware"></a>Máquinas virtuais - ativar e configurar antimalware
**Implementação através do Portal do Azure**

Para ativar o serviço Antimalware, clique em **adicionar** no painel de extensões, selecione **Antimalware da Microsoft** no painel de recursos novo, clique em **criar** da Microsoft Painel de antimalware. Clique em **criar** sem inputting quaisquer valores de configuração para ativar o Antimalware com as definições predefinidas ou introduza as definições de configuração de Antimalware para a Máquina Virtual configurada conforme mostrado na figura 2 abaixo. Consulte o **descrições** fornecido com cada definição de configuração no painel Adicionar extensão para ver os valores de configuração suportada.

![Definições de configuração de máquina virtual para o Antimalware da Microsoft](./media/azure-security-antimalware/sec-azantimal-fig2.PNG)

**Implementação no portal do Azure**

Para ativar e configurar o Antimalware da Microsoft para máquinas virtuais do Azure no portal do Azure ao aprovisionar uma Máquina Virtual, siga os passos abaixo:

1. registo de no portal do Azure em <https://portal.azure.com>

2 para criar uma nova máquina virtual, clique em **novo**, **computação**, **Virtual** **máquina**, **da galeria**(utilize criação rápida) conforme mostrado abaixo:

![Nova Máquina Virtual](./media/azure-security-antimalware/sec-azantimal-fig3.PNG)

3. Selecione o **Microsoft Windows Server** de imagem no **escolhe uma imagem** página.

4. Clique na seta à direita e a configuração de Máquina Virtual de entrada.

5. Verifique o **Antimalware da Microsoft** caixa de verificação em **extensões de segurança** na página de configuração da Máquina Virtual.

6. clique no botão Submeter para ativar e configurar o Antimalware da Microsoft para máquinas virtuais do Azure com as definições de configuração predefinida.

![Configuração da máquina virtual](./media/azure-security-antimalware/sec-azantimal-fig4.PNG)

**Implementação a utilizar a configuração de máquina virtual do Visual Studio**

Para ativar e configurar o serviço de Antimalware da Microsoft com o Visual Studio:

1. Ligue-se ao Microsoft Azure no Visual Studio.

2 escolher a Máquina Virtual no **máquinas virtuais** no nó **Explorador de servidores**

![Configuração da máquina virtual no Visual Studio](./media/azure-security-antimalware/sec-azantimal-fig5.PNG)

3. clique **configurar** para ver a página de configuração da Máquina Virtual

4. Selecione **Antimalware da Microsoft** extensão na lista pendente em **extensões instaladas** e clique em **adicionar** para configurar com a configuração de antimalware predefinida.

![Extensões instaladas](./media/azure-security-antimalware/sec-azantimal-fig6.PNG)

5. para personalizar a configuração de Antimalware predefinida, selecione a extensão (realce) o Antimalware na lista de extensões instaladas e clique em **configurar**.

6. substituir a configuração predefinida do Antimalware com a sua configuração personalizada no formato JSON suportado no **configuração pública** caixa de texto e clique em OK.

7. clique em o **atualização** botão para enviar as atualizações de configuração para a Máquina Virtual.

![Extensão de configuração da máquina virtual](./media/azure-security-antimalware/sec-azantimal-fig7.PNG)

**Nota:** a configuração de máquinas de virtuais do Visual Studio para Antimalware suporta apenas configuração do formato de JSON. O modelo de definições de configuração do JSON de Antimalware está incluído no [do Microsoft Antimalware para o Azure - exemplos de código](http://aka.ms/amazsamples "do Microsoft Antimalware para o Azure - exemplos de código"), que mostra o suportados Definições de configuração de antimalware.

**Cmdlets de implementação do utilizando o PowerShell**

Um serviço ou aplicação do Azure, pode ativar e configurar o Antimalware da Microsoft para máquinas virtuais do Azure utilizando cmdlets do PowerShell.

Para ativar e configurar o antimalware da Microsoft utilizando cmdlets do PowerShell antimalware:

1. Configurar o ambiente de PowerShell - consulte a documentação em <https://github.com/Azure/azure-powershell>
2. Utilize o cmdlet Set-AzureVMMicrosoftAntimalwareExtension Antimalware para ativar e configurar o Microsoft Antimalware para a Máquina Virtual conforme documentado no <http://msdn.microsoft.com/library/azure/dn771718.aspx>

**Nota:** a configuração de máquinas virtuais do Azure para Antimalware suporta apenas configuração do formato de JSON. O modelo de definições de configuração do JSON de Antimalware está incluído no [do Microsoft Antimalware para o Azure - exemplos de código](http://aka.ms/amazsamples "do Microsoft Antimalware para o Azure - exemplos de código"), que mostra o suportados Definições de configuração de antimalware.

### <a name="enable-and-configure-antimalware-using-powershell-cmdlets"></a>Cmdlets de ativar e configurar o Antimalware através do PowerShell
Um serviço ou aplicação do Azure, pode ativar e configurar o Antimalware da Microsoft para os serviços de nuvem do Azure utilizando cmdlets do PowerShell. Tenha em atenção que o Antimalware da Microsoft está instalado num estado desativado na plataforma de serviços em nuvem e requer uma ação por uma aplicação do Azure para ativá-la.

Para ativar e configurar o Microsoft Antimalware utilizando cmdlets do PowerShell:

1. Configurar o ambiente de PowerShell - consulte a documentação em <https://github.com/Azure/azure-sdk-tools#get-started>
2. Utilize o cmdlet Set-AzureServiceAntimalwareExtension Antimalware para ativar e configurar o Antimalware da Microsoft para o seu serviço de nuvem conforme documentado no <http://msdn.microsoft.com/library/azure/dn771718.aspx>

O modelo de definições de configuração do XML de Antimalware está incluído no [do Microsoft Antimalware para o Azure - exemplos de código](http://aka.ms/amazsamples "do Microsoft Antimalware para o Azure - exemplos de código"), que mostra o suportados Definições de configuração de antimalware.

### <a name="cloud-services-and-virtual-machines---configuration-using-powershell-cmdlets"></a>Serviços em nuvem e máquinas virtuais - cmdlets de configuração utilizando o PowerShell
Um serviço ou aplicação do Azure, pode obter a configuração de Antimalware da Microsoft para serviços em nuvem e máquinas virtuais utilizando cmdlets do PowerShell.

Para obter a configuração de Antimalware da Microsoft utilizando cmdlets do PowerShell:

1. Configurar o ambiente de PowerShell - consulte a documentação em <https://github.com/Azure/azure-sdk-tools#get-started>
2. **Para máquinas virtuais**: Utilize o cmdlet Get-AzureVMMicrosoftAntimalwareExtension Antimalware para obter a configuração de antimalware, conforme documentado no <http://msdn.microsoft.com/library/azure/dn771719.aspx>
3. **Para serviços em nuvem**: Utilize o cmdlet Get-AzureServiceAntimalwareConfig Antimalware para obter a configuração de Antimalware, conforme documentado no <http://msdn.microsoft.com/library/azure/dn771722.aspx>

### <a name="remove-antimalware-configuration-using-powershell-cmdlets"></a>Remova os cmdlets de configuração do Antimalware com o PowerShell
Um serviço ou aplicação do Azure pode remover a configuração de Antimalware e de qualquer configuração de monitorização de Antimalware associados as relevantes Antimalware do Azure e diagnóstico extensões de serviço associadas com o serviço em nuvem ou Máquina Virtual.

Para remover o Antimalware da Microsoft utilizando cmdlets do PowerShell:

1. Configurar o ambiente de PowerShell - consulte a documentação em<Link Broken>
2. **Para máquinas virtuais**: utilizar o cmdlet Remove-AzureVMMicrosoftAntimalwareExtension Antimalware, conforme documentado no <http://msdn.microsoft.com/library/azure/dn771720.aspx>
3. **Para serviços em nuvem:** utilizar o cmdlet Remove-AzureServiceAntimalwareExtension Antimalware, conforme documentado no <http://msdn.microsoft.com/library/azure/dn771717.aspx>

Para **ativar** recolha de eventos de antimalware para uma máquina virtual utilizando o Portal de pré-visualização do Azure:

1. Clique em qualquer parte na lente de monitorização no painel da Máquina Virtual
2. Clique no comando de diagnóstico no painel de métrica
3. Selecione **estado** ON e verifique a opção de sistema de eventos do Windows
4. . Pode optar por desmarque todas as outras opções na lista ou deixe-os ativado por suas necessidades de serviço de aplicações.
5. As categorias de eventos de Antimalware "Error", "Aviso", "Informativa", etc., são capturadas na sua conta do Storage do Azure.

Eventos de antimalware são recolhidos a partir de registos de sistema de eventos do Windows à sua conta do Storage do Azure. Pode configurar a conta de armazenamento para a Máquina Virtual recolher eventos de Antimalware, selecionando a conta de armazenamento adequado.

![Métricas e diagnóstico](./media/azure-security-antimalware/sec-azantimal-fig8.PNG)

> [!NOTE]
> Para obter mais informações sobre como o registo de diagnóstico do Azure Antimalware, leia o artigo [ativar registo de diagnóstico do Azure Antimalware](https://blogs.msdn.microsoft.com/azuresecurity/2016/04/19/enabling-diagnostics-logging-for-azure-antimalware/).
>
>

### <a name="enable-and-configure-antimalware-monitoring-using-powershell-cmdlets"></a>Ativar e configurar a monitorização de antimalware utilizando cmdlets do powerShell
Pode ativar a recolha de eventos de Antimalware da Microsoft para o seu serviço em nuvem ou Máquina Virtual utilizando o diagnóstico do Azure através de cmdlets do PowerShell de Antimalware. A extensão de diagnóstico do Azure pode ser configurada para capturar eventos da origem de registo de eventos do sistema "Antimalware da Microsoft" a sua conta do Storage do Azure. As categorias de eventos de Antimalware "Error", "Aviso", "Informativa", etc., são capturadas na sua conta do Storage do Azure.

Para ativar a recolha de eventos de Antimalware para a conta de armazenamento do Azure com os cmdlets do PowerShell:

1. Configurar o ambiente de PowerShell - consulte <https://github.com/Azure/azure-sdk-tools#get-started>
2. **Para máquinas virtuais** -utilize o cmdlet Set-AzureVMMicrosoftAntimalwareExtension Antimalware com opção de monitorização no conforme documentado no <http://msdn.microsoft.com/library/azure/dn771716.aspx>
3. **Para serviços em nuvem** -utilize o cmdlet Set-AzureServiceAntimalwareExtension Antimalware com opção de monitorização no conforme documentado no <http://msdn.microsoft.com/library/azure/dn771718.aspx>

Pode ver os eventos não processados de Antimalware observando a *WADWindowsEventLogsTable* tabela na sua conta do Storage do Azure que configurou para ativar a monitorização de Antimalware. Isto pode ser útil para validar que recolha de eventos de Antimalware está a funcionar, incluindo obtenção aprofundadas sobre o estado de funcionamento do serviço Antimalware. Para obter mais detalhes, incluindo o código de exemplo sobre como extrair os eventos de Antimalware da sua conta de armazenamento, consulte [do Microsoft Antimalware para o Azure - exemplos de código](http://aka.ms/amazsamples "do Microsoft Antimalware para o Azure - exemplos de código").
